{% extends "base.html" %}

{% block content%}
<div class="container">
	<h3 class="text-center">Messages</h3>
	<div class="col-lg-1"></div>
	<div class="col-lg-10">
		<table class="table table-hover">
			<th class="text-center">Title</th>
			<th class="text-center">Sender</th>
			<th class="text-center">Sended Time</th>
			<th class="text-center">State</th>
			<th class="text-center">Action</th>
			{% for msg in msg_list %}
				<tr class="text-center">
					<td>{{msg.get_title}}</td>
					<td>{{msg.sender.get_nick_name}}</td>
					<td>{{msg.get_sended_time}}</td>
					<td>
						{% if msg.is_readed %}
				  			<button type="button" class="btn btn-link btn-sm" disabled="disabled">Readed</button>
				  		{% else %}
				  			<button type="button" class="btn btn-link btn-sm" disabled="disabled">Not Readed</button>
				  		{% endif %}
					</td>
					<td>
					<!-- Single button -->
					 	<a href=""data-toggle="modal" data-target="#messageModal{{forloop.counter0}}"><span class="glyphicon glyphicon-zoom-in"></span></a>

						<a href="{% url 'messages:delete' msg.id %}" style="padding-left: 20px"><span class="glyphicon glyphicon-remove"></span></a>


						<div class="modal fade" id="messageModal{{forloop.counter0}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
						  	<div class="modal-dialog" role="document">
							    <div class="modal-content">
								    <div class="modal-header">
								    	<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
								        <h4 class="modal-title" id="exampleModalLabel">{{msg.get_title}}</h4>
								    </div>
							     	<div class="modal-body">
							          	<div class="form-group">
							            	<label for="recipient-name" class="control-label">Sender:</label>
							            	<input type="text" class="form-control" readonly="readonly" id="recipient-name" value="@{{msg.sender.get_nick_name}}">
							          	</div>
							          	<div class="form-group">
							            	<label for="message-text" class="control-label">Message:</label>
							            	<textarea style="height: 200px" class="form-control" readonly="readonly" id="message-text">{{msg.get_message}}</textarea>
							          	</div>
							      	</div>
								     	<div class="modal-footer">
											<button class="btn btn-primary center-block" type="button" data-toggle="collapse" data-target="#collapseExample{{msg.id}}" aria-expanded="false" aria-controls="collapseExample">
										  Reply
											</button>
											<div class="collapse" id="collapseExample{{msg.id}}">
										  		<div class="well">
										  			<form id="form{{msg.id}}" action="{%url 'accounts:send' msg.sender.id%}" method="post">
											  		{% csrf_token %}
												  		<div class="form-group">
												  			<textarea required="required" class="form-control" name="message"></textarea>
												  		</div>
												  		<div class="form-group">
		  									        		<button type="submit" class="btn btn-primary center-block">Send<span class="glyphicon glyphicon-send"></span></button>
		  									        	</div>
		  									        	<input type="text" name="title" style="display: none;" value="Reply@{{msg.get_title}}"></input>
	  									        	</form>
										  		</div>

											</div>
							      	</div>
							    </div>
						  	</div>
						</div>
					</td>
				</tr>
			{% endfor %}
		</table>
	</div>
</div>
{% endblock %}